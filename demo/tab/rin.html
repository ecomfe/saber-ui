<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Tab - Saber UI Demo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <link rel="stylesheet" href="tab.css">
    <link rel="stylesheet" href="demo.css">
    <script src="http://s1.bdstatic.com/r/www/cache/ecom/esl/1-6-10/esl.js"></script>
    <script>
    require.config({
        'packages': [
            {
                'name': 'saber-dom',
                'location': '../dep/saber-dom/0.4.0/src',
                'main': 'main'
            },
            {
                'name': 'saber-string',
                'location': '../dep/saber-string/0.3.0/src',
                'main': 'main'
            },
            {
                'name': 'saber-lang',
                'location': '../dep/saber-lang/0.3.1/src',
                'main': 'main'
            },
            {
                'name': 'saber-emitter',
                'location': '../dep/saber-emitter/0.5.0/src',
                'main': 'emitter'
            },
            {
                'name': 'saber-scroll',
                'location': '../dep/saber-scroll/0.1.2/src',
                'main': 'main'
            },
            {
                'name': 'saber-run',
                'location': '../dep/saber-run/0.2.0/src',
                'main': 'main'
            },
            {
                'name': 'saber-promise',
                'location': '../dep/saber-promise/0.1.2/src',
                'main': 'promise'
            },
            {
                'name': 'saber-tap',
                'location': '../dep/saber-tap/0.1.2/src',
                'main': 'tap'
            },
            {
                'name': 'saber-matchmedia',
                'location': '../dep/saber-matchmedia/0.1.0/src',
                'main': 'main'
            },
            {
                'name': 'saber-ui',
                'location': '../../src',
                'main': 'main'
            }
        ],
        'paths': {}
    });
    </script>

</head>

<body>
    <s-bar ui="primary header">
        <a href="./" class="ui-btn" data-ui="primary">&lt;返回</a>
        <h1 data-ui="title">Tab - Saber UI</h1>
        <a href="#" class="ui-btn" data-ui="primary">设置</a>
    </s-bar>

    <div class="container">
        <h2>静态化构建</h2>
        <div id="wrapper1" class="wrapper">
            <div class="loading">初始化中...</div>

            <s-tab option="activeIndex:2">
                <s-tab-navigator>
                    <s-tab-trigger for="a">A</s-tab-trigger>
                    <s-tab-trigger style="color: red">No</s-tab-trigger>
                    <s-tab-trigger for="b">B</s-tab-trigger>
                    <s-tab-trigger for="c">C</s-tab-trigger>
                </s-tab-navigator>

                <div id="a" class="panel">我是A</div>
                <div id="b" class="panel">我是B</div>
                <div id="c" class="panel">我是C</div>
                <div class="panel" style="color:red">我是永远显示的哦</div>
            </s-tab>

            <div id="tabConsole">
                <a href="#" class="ui-btn" data-ui="primary small" id="setTabBtn">更换tab内容</a>
                <a href="#" class="ui-btn" data-ui="success small" id="addTabBtn">添加新tab</a>
                <a href="#" class="ui-btn" data-ui="danger small" id="removeTabBtn">删除新tab</a>
                <a href="#" class="ui-btn" data-ui="danger small" id="switchTabBtn">禁用tab</a>
                <a href="#" class="ui-btn" data-ui="warning small" id="toggleTabBtn">隐藏tab</a>
                <a href="#" class="ui-btn" data-ui="small" id="dirTabBtn">纵向tab</a>
            </div>
        </div>
    </div>

    <script>
    require(
        [
            'saber-tap',
            'saber-dom/selector',
            'saber-ui',
            'saber-ui/Tab'
        ],
        function( Tap, selector, ui, Tab ) {
            var $ = selector.query;
            var initSuccess = function () {
                setTimeout(
                    function () {
                        $( '#wrapper1 .loading' ).style.display = 'none';
                    },
                    500
                );
            };

            // 300ms 点击延迟修复
            Tap.mixin( $( '.container' ) );


            // 更新全局配置
            ui.config( { uiPrefix: 's-ui', pluginPrefix: 's-plugin' } );


            // 构建
            var tabs = ui.init( $( '#wrapper1' ), { success: initSuccess } );
            tabs[ 0 ].beforeChange = function ( oldIndex, newIndex ) {
                // console.info( 'from %s to %s', oldIndex, newIndex );
                return newIndex !== 1;
            };

            // 控制器组
            $( '#setTabBtn' ).onclick = function () {
                var i = tabs[ 0 ].get( 'activeIndex' );
                var d = [
                    { title: '教育', panel: 'a' },
                    { title: '不能点' },
                    { title: '健康', panel: 'c' },
                    { title: '二手车', panel: 'b' },
                ];
                tabs[ 0 ].setProperties( { tabs: d, activeIndex: i } );
            };

            var newTabData = { title: '新Tab' };
            $( '#addTabBtn' ).onclick = function () {
                tabs[ 0 ].insert( newTabData, 2 );
            };
            $( '#removeTabBtn' ).onclick = function () {
                tabs[ 0 ].remove( newTabData );
            };
            $( '#switchTabBtn' ).onclick = function () {
                var isDisabeld = tabs[ 0 ].isDisabled();
                tabs[ 0 ].setDisabled( !isDisabeld );
                this.innerHTML = isDisabeld ? '禁用tab' : '启用tab';
            };
            $( '#toggleTabBtn' ).onclick = function () {
                var isHidden = tabs[ 0 ].isHidden();
                tabs[ 0 ].toggle();
                this.innerHTML = isHidden ? '隐藏tab' : '显示tab';
            };
            $( '#dirTabBtn' ).onclick = function () {
                var isVertical = tabs[ 0 ].get( 'orientation' ) === 'vertical';
                tabs[ 0 ].set(
                    'orientation', isVertical ? 'horizontal' : 'vertical' );
                this.innerHTML = isVertical ? '纵向tab' : '横向tab';
            };
        }
    );
    </script>
</body>
</html>
