<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Tab - Saber UI Demo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <link rel="stylesheet" href="tab.css">
    <link rel="stylesheet" href="demo.css">
    <script src="http://s1.bdstatic.com/r/www/cache/ecom/esl/1-6-10/esl.js"></script>
    <script>
    require.config({
        'packages': [
            {
                'name': 'saber-dom',
                'location': '../dep/saber-dom/0.4.0/src',
                'main': 'main'
            },
            {
                'name': 'saber-string',
                'location': '../dep/saber-string/0.3.0/src',
                'main': 'main'
            },
            {
                'name': 'saber-lang',
                'location': '../dep/saber-lang/0.3.1/src',
                'main': 'main'
            },
            {
                'name': 'saber-emitter',
                'location': '../dep/saber-emitter/0.5.0/src',
                'main': 'emitter'
            },
            {
                'name': 'saber-scroll',
                'location': '../dep/saber-scroll/0.1.2/src',
                'main': 'main'
            },
            {
                'name': 'saber-run',
                'location': '../dep/saber-run/0.2.0/src',
                'main': 'main'
            },
            {
                'name': 'saber-promise',
                'location': '../dep/saber-promise/0.1.2/src',
                'main': 'promise'
            },
            {
                'name': 'saber-tap',
                'location': '../dep/saber-tap/0.1.2/src',
                'main': 'tap'
            },
            {
                'name': 'saber-matchmedia',
                'location': '../dep/saber-matchmedia/0.1.0/src',
                'main': 'main'
            },
            {
                'name': 'saber-ui',
                'location': '../../src',
                'main': 'main'
            }
        ],
        'paths': {}
    });
    </script>

</head>

<body>
    <s-bar ui="primary header">
        <a href="./" class="ui-btn" data-ui="primary">&lt;返回</a>
        <h1 data-ui="title">Tab - Saber UI</h1>
        <a href="#" class="ui-btn" data-ui="primary">设置</a>
    </s-bar>

    <div class="container">
        <h2>静态化构建</h2>
        <div id="wrapper3" class="wrapper">
            <div class="loading">初始化中...</div>

            <h3>滚动导航</h3>
            <div s-ui="type:Tab;scroll:true;">
                <ul data-role="navigator">
                    <li>教育</li>
                    <li>动漫</li>
                    <li>健康</li>
                    <li>生活</li>
                    <li>游戏</li>
                    <li>美女</li>
                    <li>汽车</li>
                    <li>新闻</li>
                    <li>话题</li>
                    <li>焦点</li>
                    <li>贴吧</li>
                    <li>ECOM</li>
                    <li>中国</li>
                    <li>美国</li>
                    <li>北京</li>
                    <li>百度</li>
                    <li>海辉</li>
                    <li>文思</li>
                    <li>大厦</li>
                </ul>
            </div>

            <h3>复合列表</h3>
            <a href="#" class="ui-btn" data-ui="primary" id="menu">分类</a>
            <div class="dropmenu dropmenu-hidden">
                <div class="menu">
                    <div s-ui="type:Tab;id:list;orientation:vertical;scroll:true;" s-plugin-scroll="horizontal:false;">
                        <ul data-role="navigator">
                            <li data-for="a1">教育</li>
                            <li data-for="a2">动漫</li>
                            <li data-for="a3">健康</li>
                            <li data-for="a4">生活</li>
                            <li data-for="a5">游戏</li>
                            <li data-for="a6">美女</li>
                            <li data-for="a7">汽车</li>
                            <li data-for="a8">新闻</li>
                            <li data-for="a9">话题</li>
                            <li data-for="a10">焦点</li>
                            <li data-for="a11">贴吧</li>
                            <li data-for="a12">ECOM</li>
                            <li data-for="a13">中国</li>
                            <li data-for="a14">美国</li>
                            <li data-for="a15">北京</li>
                            <li data-for="a16">百度</li>
                            <li>海辉</li>
                            <li>文思</li>
                            <li data-for="a17">大厦</li>
                        </ul>
                    </div>
                </div>
                <div class="panels">
                    <div>
                        <div id="a1" class="panel">教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx教育xxxxxxSFSDGEEGEHEHRHHEHxxxxxxxxxx</div>
                        <div id="a2" class="panel">动漫xxxxxxxxxxxxxxxx</div>
                        <div id="a3" class="panel">健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx健康xxxxxxxxxxxxxxxx</div>
                        <div id="a4" class="panel">生活xxxxxxxxxxxxxxxx</div>
                        <div id="a5" class="panel">游戏xxxxxxxxxxxxxxxx</div>
                        <div id="a6" class="panel">美女xxxxxxxxxxxxxxxx</div>
                        <div id="a7" class="panel">汽车xxxxxxxxxxxxxxxx</div>
                        <div id="a8" class="panel">新闻xxxxxxxxxxxxxxxx</div>
                        <div id="a9" class="panel">话题xxxxxxxxxxxxxxxx</div>
                        <div id="a10" class="panel">焦点xxxxxxxxxxxxxxxx</div>
                        <div id="a11" class="panel">贴吧xxxxxxxxxxxxxxxx</div>
                        <div id="a12" class="panel">ECOMxxxxxxxxxxxxxxxx</div>
                        <div id="a13" class="panel">中国xxxxxxxxxxxxxxxx</div>
                        <div id="a14" class="panel">美国xxxxxxxxxxxxxxxx</div>
                        <div id="a15" class="panel">北京xxxxxxxxxxxxxxxx</div>
                        <div id="a16" class="panel">百度xxxxxxxxxxxxxxxx</div>
                        <div id="a17" class="panel">大厦xxxxxxxxxxxxxxxx</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
    require(
        [
            'saber-tap',
            'saber-dom',
            'saber-scroll',
            'saber-scroll/plugin/scrollbar',
            'saber-ui',
            'saber-ui/Button',
            'saber-ui/Tab',
            'saber-ui/plugin/TabScroll'
        ],
        function( Tap, dom, Scroll, ScrollBar, ui, Button, Tab ) {
            var $ = dom.query;
            var $$ = dom.queryAll;
            var wrapper2 = $( '#wrapper4' );
            var dropmenu = $( '.dropmenu' );
            var initSuccess = function () {
                setTimeout(
                    function () {
                        $( '.loading' ).style.display = 'none';
                    },
                    500
                );
            };

            // 300ms 点击延迟修复
            Tap.mixin( $( '.container' ) );


            // 更新全局配置
            ui.config( { uiPrefix: 's-ui', pluginPrefix: 's-plugin' } );


            // 静态化
            var tabs = ui.init( $( '#wrapper3' ), { success: initSuccess } );

            var tab = ui.get( 'list' );
            var panelScroll;

            $( '#menu' ).onclick = function () {
                var cls = 'dropmenu-hidden';
                var isHide = dom.hasClass( dropmenu, cls );

                dom[
                    isHide ? 'removeClass' : 'addClass'
                ]( dropmenu, cls );

                if ( isHide && !panelScroll) {
                    panelScroll = Scroll(
                        $( '.panels' ),
                        { scrollbar: true }
                    );

                    // TODO:
                    // 默认父容器隐藏状态，scroll无法计算
                    // 这里借助panel的一次性初始化时机一起重绘下
                    tab.get( 'plugins' )[ 'TabScroll' ].repaint();
                }
            };

            tab.on( 'change', function () {
                panelScroll && panelScroll.repaint();
            });
            tab.on( 'afterdispose', function () {
                panelScroll && panelScroll.destroy();
                panelScroll = null;
            });

        }
    );

    document.addEventListener( 'touchstart', function(){}, false);
    </script>
</body>
</html>
